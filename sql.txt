CREATE DATABASE DH
USE DH
GO
CREATE TABLE TAIKHOAN
( 
  EMAIL VARCHAR(255) PRIMARY KEY,
  MATKHAU NVARCHAR(255),
  TENDANGNHAP NVARCHAR(255)
)
GO
CREATE TABLE NHANVIEN
( MANV int identity(1,1) PRIMARY KEY,
  TENNV NVARCHAR(255),
  NGAYSINH DATE,
  SDT varchar(20),
  EMAIL VARCHAR(255) FOREIGN KEY REFERENCES TAIKHOAN(EMAIL),
  AVATAR VARCHAR(MAX), TENCHUCNANG NVARCHAR(255),
)
 
  CREATE TABLE NHAPHANG
	  ( MANHAPHANG int identity(1,1) PRIMARY KEY,
	   THANHTIEN FLOAT,
	   NGAYNHAP DATE,
	   MANV int FOREIGN KEY REFERENCES NHANVIEN(MANV), 
	   TRANGTHAI BIT
	)
  CREATE TABLE SALE
  (
  MASALE INT identity(1,1) PRIMARY KEY,
  PHANTRAMSALE INT,
  NGAYBATDAU DATE,
  NGAYHETHAN DATE,
  TRANGTHAI BIT
  )
 
    CREATE TABLE MATHANG
(
 MAMATHANG VARCHAR(255) PRIMARY KEY,
 TENHANG NVARCHAR(255),
 ANHSANPHAM  VARCHAR(MAX),
 NGAYSANXUAT DATE,
 TENHANGSANXUAT NVARCHAR(250),
 GIAHANG FLOAT,
 BAOHANH NVARCHAR(250),
 LOAI  NVARCHAR(255),
 KICHTHUOC INT,
 TRANGTHAI BIT,
 MASALE INT FOREIGN KEY REFERENCES SALE(MASALE)
 ) 
 
   CREATE TABLE HINHANH
 (
  MAHINHANH INT identity(1,1)PRIMARY KEY,
  MAMATHANG VARCHAR(255) FOREIGN KEY REFERENCES MATHANG(MAMATHANG),
  ANHS VARCHAR(MAX)
  )
  CREATE TABLE CHITIETPHIEUNHAP
	   (  MAMATHANG VARCHAR(255) FOREIGN KEY REFERENCES MATHANG(MAMATHANG),
	      MACTPHIEUNHAP int identity(1,1) PRIMARY KEY,
		  SOLUONG INT,
		  MANHAPHANG  int FOREIGN KEY REFERENCES  NHAPHANG(MANHAPHANG),
		  GIANHAP FLOAT,
)

 CREATE TABLE KHACHHANG 
 (
 MAKHACHHANG int identity(1,1) PRIMARY KEY,
 TENKHACHHANG NVARCHAR(255),
 SDT varchar(20),
 EMAIL VARCHAR(255) FOREIGN KEY REFERENCES TAIKHOAN(EMAIL),
  AVATAR VARCHAR(MAX),
  THANHVIEN NVARCHAR(255),
  XU FLOAT
 )

CREATE TABLE VOUCHER
( 
MAVOUCHER int identity(1,1) PRIMARY KEY,
PHANTRAMGIAMGIA INT ,
DIEUKIEN NVARCHAR(MAX),
TRANGTHAI BIT,
)
CREATE TABLE QUANLYVOUCHER
(
MAQUANLYVOUCHER  int identity(1,1) PRIMARY KEY,
MAKHACHHANG INT FOREIGN KEY REFERENCES KHACHHANG(MAKHACHHANG),
MAVOUCHER  INT FOREIGN KEY REFERENCES VOUCHER(MAVOUCHER),
GHICHU NVARCHAR(MAX),
NOIDUNG NVARCHAR(MAX),
NGAYBATDAU DATE,
NGAYKETTHUC DATE,
TRANGTHAI BIT
)
CREATE TABLE THANHTOAN
(
MATHANHTOAN int identity(1,1) PRIMARY KEY,
PHUONGTHUCTHANHTOAN NVARCHAR(255),
MATHE NVARCHAR(255),
NGAYTHANHTOAN DATE
)

CREATE TABLE TRANGTHAIGIAOHANG
(
MAVANDON int identity(1,1) PRIMARY KEY,
VITRI NVARCHAR(255),
THOIGIANGIAOHANG DATE,
THOIGIANNHANHANG DATE

)

CREATE TABLE DIADIEM
(
MADIADIEM int identity(1,1) PRIMARY KEY,
MAKHACHHANG INT FOREIGN KEY REFERENCES KHACHHANG(MAKHACHHANG),
TENDIACHI NVARCHAR(255),
SDT INT
)


CREATE TABLE DATHANG
 ( 
	  MADH NVARCHAR(20) PRIMARY KEY,
	  NGAYMUA DATE,
      TONGTIEN FLOAT,
	  MAKHACHHANG INT FOREIGN KEY REFERENCES KHACHHANG(MAKHACHHANG),
	   TRANGTHAI BIT,
	   MADIADIEM INT FOREIGN KEY REFERENCES DIADIEM(MADIADIEM),
	   MAQUANLYVOUCHER INT FOREIGN KEY REFERENCES QUANLYVOUCHER(MAQUANLYVOUCHER),
	   MATHANHTOAN INT FOREIGN KEY REFERENCES THANHTOAN(MATHANHTOAN),
	   MAVANDON INT FOREIGN KEY REFERENCES TRANGTHAIGIAOHANG(MAVANDON)

 )
	  CREATE TABLE CHITIETDATHANG
	 (
	 MADH  NVARCHAR(20)  FOREIGN KEY REFERENCES DATHANG(MADH), 
	MAMATHANG VARCHAR(255) FOREIGN KEY REFERENCES MATHANG(MAMATHANG),
	 SOLUONG INT,
	 GIABAN FLOAT,
	 MACTDH INT identity(1,1) primary key,
	
	  )
CREATE TABLE GIOHANG
(
     MAGIOHANG int identity(1,1) PRIMARY KEY,
	 MAKHACHHANG  int FOREIGN KEY REFERENCES KHACHHANG(MAKHACHHANG),
	 TRANGTHAI BIT
	 )
	  CREATE TABLE CHITIETGIOHANG(
	  MACHITIETGIOHANG int identity(1,1) PRIMARY KEY,
	 MAMATHANG VARCHAR(255) FOREIGN KEY REFERENCES MATHANG(MAMATHANG),
	  MAGIOHANG int FOREIGN KEY REFERENCES GIOHANG(MAGIOHANG),
       SOLUONGMUA INT
	  )	  
CREATE TABLE THONGKE(
 MATHONGKE INT identity(1,1) PRIMARY KEY,
 NGAYTHONGKE DATE,
 TONGTIEN FLOAT,
 MASPBANCHAY NVARCHAR(100),
 SANPHAMBANCHAY NVARCHAR(100),
 SOLUONGBANRA INT,
 SOLUONGBANCHAY INT
 )
 CREATE TABLE THONGKENHAPHANG(
 MATHONGKE INT identity(1,1) PRIMARY KEY,
 NGAYTHONGKE DATE,
 TONGTIEN FLOAT
 )